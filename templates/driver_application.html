{% extends "base/layout.html" %}

{% block title %}Hae kuljettajaksi ‚Äì Levoro{% endblock %}

{% block extra_css %}
<style>
    .application-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }


    .application-header {
        position: relative;
        text-align: center;
        margin-bottom: 48px;
        padding: 48px 24px;
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.16), rgba(37, 99, 235, 0.08));
        border: 1px solid var(--color-primary-100, #dbeafe);
        border-radius: 20px;
        color: var(--color-gray-800, #1f2937);
        overflow: hidden;
    }

    .application-header::before {
        content: "";
        position: absolute;
        inset: 0;
        background:
            radial-gradient(circle at 20% 20%, rgba(59, 130, 246, 0.18), transparent 55%),
            radial-gradient(circle at 80% 10%, rgba(37, 99, 235, 0.12), transparent 45%),
            radial-gradient(circle at 50% 100%, rgba(14, 116, 144, 0.12), transparent 50%);
        opacity: 0.65;
    }

    .application-header>* {
        position: relative;
        z-index: 1;
    }

    .application-badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 8px 18px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.75);
        color: var(--color-primary-700, #1d4ed8);
        font-weight: 600;
        font-size: 0.9rem;
        margin-bottom: 18px;
        box-shadow: 0 6px 18px rgba(59, 130, 246, 0.18);
    }

    .application-title {
        font-size: clamp(2.2rem, 4vw, 2.9rem);
        font-weight: 800;
        margin-bottom: 14px;
        color: var(--color-gray-900, #0f172a);
    }

    .application-subtitle {
        font-size: 1.05rem;
        color: var(--color-gray-600, #4b5563);
        max-width: 640px;
        margin: 0 auto;
        line-height: 1.6;
    }

    .application-form {
        background: white;
        border-radius: 12px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        padding: 40px;
    }

    .form-section {
        margin-bottom: 32px;
    }

    .form-section-title {
        font-size: 1.3rem;
        font-weight: 700;
        color: var(--color-gray-900, #111827);
        margin-bottom: 16px;
        padding-bottom: 8px;
        border-bottom: 2px solid var(--color-primary-100, #dbeafe);
    }

    .form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }

    .form-grid.single-column {
        grid-template-columns: 1fr;
    }

    .form-group {
        margin-bottom: 20px;
    }

    .form-group.full-width {
        grid-column: 1 / -1;
    }

    .form-label {
        display: block;
        font-weight: 600;
        color: var(--color-gray-700, #374151);
        margin-bottom: 6px;
    }

    .form-label.required::after {
        content: " *";
        color: var(--color-red-500, #ef4444);
    }

    .form-input,
    .form-select,
    .form-textarea {
        width: 100%;
        padding: 12px 16px;
        border: 2px solid var(--color-gray-200, #e5e7eb);
        border-radius: 8px;
        font-size: 1rem;
        transition: all 0.2s ease;
        box-sizing: border-box;
    }

    .form-input:focus,
    .form-select:focus,
    .form-textarea:focus {
        outline: none;
        border-color: var(--color-primary, #3b82f6);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .form-textarea {
        min-height: 100px;
        resize: vertical;
    }

    .form-help {
        font-size: 0.875rem;
        color: var(--color-gray-600, #4b5563);
        margin-top: 4px;
    }

    .form-actions {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 16px;
        margin-top: 40px;
        padding-top: 30px;
        border-top: 1px solid var(--color-gray-200, #e5e7eb);
    }

    .btn {
        display: inline-block;
        padding: 14px 32px;
        font-size: 1rem;
        font-weight: 600;
        text-decoration: none;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .form-actions .btn {
        margin: 0;
        min-width: 190px;
    }

    .btn-primary {
        background: var(--color-primary, #3b82f6);
        color: white;
    }

    .btn-primary:hover {
        background: var(--color-primary-600, #2563eb);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }

    .btn-ghost {
        background: transparent;
        color: var(--color-gray-600, #4b5563);
        border: 2px solid var(--color-gray-300, #d1d5db);
    }

    .btn-ghost:hover {
        background: var(--color-gray-50, #f9fafb);
        border-color: var(--color-gray-400, #9ca3af);
    }

    .required-note {
        background: var(--color-amber-50, #fffbeb);
        border: 1px solid var(--color-amber-200, #fde68a);
        color: var(--color-amber-800, #92400e);
        padding: 12px 16px;
        border-radius: 8px;
        margin-bottom: 30px;
        font-size: 0.9rem;
    }

    @media (max-width: 768px) {
        .form-grid {
            grid-template-columns: 1fr;
        }

        .application-form {
            padding: 24px;
        }

        .application-title {
            font-size: 2.1rem;
        }

        .application-subtitle {
            font-size: 1rem;
        }

        .form-actions {
            flex-direction: column;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="application-container">
    <div class="application-header">
        <div class="application-badge">Liity Levoro-kuljettajaksi</div>
        <h1 class="application-title">Hae kuljettajaksi</h1>
        <p class="application-subtitle">
            Rekister√∂idy kuljettajaksi Levoron j√§rjestelm√§√§n.
            Admin hyv√§ksyy hakemuksesi, jonka j√§lkeen voit aloittaa kuljettajana.
        </p>
    </div>

    <form class="application-form" method="POST" action="/hae-kuljettajaksi" enctype="multipart/form-data">
        <div class="required-note">
            <strong>Huomio:</strong> T√§hdell√§ (*) merkityt kent√§t ovat pakollisia.
        </div>

        <!-- Personal Information -->
        <div class="form-section">
            <h2 class="form-section-title">Henkil√∂tiedot</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label required" for="first_name">Etunimi</label>
                    <input type="text" id="first_name" name="first_name" class="form-input" required maxlength="50"
                        placeholder="Etunimi" value="{{ request.form.get('first_name', '') }}">
                </div>
                <div class="form-group">
                    <label class="form-label required" for="last_name">Sukunimi</label>
                    <input type="text" id="last_name" name="last_name" class="form-input" required maxlength="80"
                        placeholder="Sukunimi" value="{{ request.form.get('last_name', '') }}">
                </div>
                <div class="form-group full-width">
                    <label class="form-label required" for="email">S√§hk√∂posti</label>
                    <input type="email" id="email" name="email" class="form-input" required maxlength="100"
                        placeholder="nimi@esimerkki.fi" value="{{ request.form.get('email', '') }}">
                </div>
                <div class="form-group full-width">
                    <label class="form-label required" for="phone">Puhelinnumero</label>
                    <input type="tel" id="phone" name="phone" class="form-input" required maxlength="20"
                        placeholder="+358 40 123 4567" value="{{ request.form.get('phone', '') }}">
                </div>
            </div>
        </div>

        <!-- Password -->
        <div class="form-section">
            <h2 class="form-section-title">Salasana</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label required" for="password">Salasana</label>
                    <input type="password" id="password" name="password" class="form-input" required minlength="6"
                        placeholder="V√§hint√§√§n 6 merkki√§">
                    <div class="form-help">Salasana tulee olla v√§hint√§√§n 6 merkki√§ pitk√§</div>
                </div>
                <div class="form-group">
                    <label class="form-label required" for="password_confirm">Vahvista salasana</label>
                    <input type="password" id="password_confirm" name="password_confirm" class="form-input" required
                        placeholder="Sy√∂t√§ salasana uudelleen">
                </div>
            </div>
        </div>

        <!-- Driver's License Images -->
        <!-- TEMPORARILY DISABLED: License upload removed for driver re-registration period -->
        <!--
        <div class="form-section">
            <h2 class="form-section-title">üìÑ Ajokortti</h2>
            <div class="form-help" style="margin-bottom: 20px; font-size: 0.95rem;">
                Lataa selke√§t kuvat ajokortistasi molemmilta puolilta. Varmista, ett√§ kaikki tiedot ovat luettavissa.
            </div>
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label required" for="license_front">Ajokortti (etuosa)</label>
                    <input type="file" id="license_front" name="license_front" class="form-input"
                           accept=".jpg,.jpeg,.png,.webp" required>
                    <div class="form-help">Ajokortin etupuoli (max 5MB)</div>
                </div>
                <div class="form-group">
                    <label class="form-label required" for="license_back">Ajokortti (takaosa)</label>
                    <input type="file" id="license_back" name="license_back" class="form-input"
                           accept=".jpg,.jpeg,.png,.webp" required>
                    <div class="form-help">Ajokortin takapuoli (max 5MB)</div>
                </div>
            </div>
        </div>
        -->

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">L√§het√§ hakemus</button>
            <a href="/" class="btn btn-ghost">Peruuta</a>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Form validation and UX improvements
    document.addEventListener('DOMContentLoaded', function () {
        const form = document.querySelector('.application-form');
        const submitButton = form.querySelector('button[type="submit"]');
        const passwordInput = document.getElementById('password');
        const passwordConfirmInput = document.getElementById('password_confirm');

        // Password validation
        function validatePasswords() {
            const password = passwordInput.value;
            const passwordConfirm = passwordConfirmInput.value;

            if (passwordConfirm && password !== passwordConfirm) {
                passwordConfirmInput.setCustomValidity('Salasanat eiv√§t t√§sm√§√§');
                return false;
            } else {
                passwordConfirmInput.setCustomValidity('');
                return true;
            }
        }

        passwordInput.addEventListener('input', validatePasswords);
        passwordConfirmInput.addEventListener('input', validatePasswords);

        form.addEventListener('submit', function (e) {
            // Validate passwords before submission
            if (!validatePasswords()) {
                e.preventDefault();
                alert('Salasanat eiv√§t t√§sm√§√§. Tarkista salasanat.');
                return;
            }

            // Disable submit button to prevent double submission
            submitButton.disabled = true;
            submitButton.textContent = 'L√§hetet√§√§n...';

            // Re-enable after 3 seconds if form doesn't submit
            setTimeout(() => {
                submitButton.disabled = false;
                submitButton.textContent = 'L√§het√§ hakemus';
            }, 3000);
        });

        // Phone number formatting
        const phoneInput = document.getElementById('phone');
        phoneInput.addEventListener('input', function (e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.startsWith('358')) {
                value = '+' + value;
            } else if (value.startsWith('0')) {
                value = '+358' + value.substring(1);
            } else if (!value.startsWith('+')) {
                value = '+358' + value;
            }
            e.target.value = value;
        });
    });
</script>
{% endblock %}